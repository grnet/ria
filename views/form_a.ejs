<%- include('partials/head.ejs') %>
    <div class="MuiContainer-root jss110 MuiContainer-maxWidthLg">
        <div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-4">
            <div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-8">
                <br>
                <div>
                    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
                        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
                        crossorigin="anonymous">
                    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
                    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
                        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
                        crossorigin="anonymous"></script>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/downloadjs/1.4.8/download.min.js"></script>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/countable/3.0.1/Countable.min.js"></script>
                    <script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.js"></script>
                    <script src="https://cdn.ckeditor.com/4.16.1/standard/ckeditor.js"></script>
                    <link rel="stylesheet" href="//cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">
                    <script src="//cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>


                    <br>
                    <input type="button" name="back" class="back" value="Πίσω" />
                    <br><br>
                    <form id="edit_form" enctype="multipart/form-data">

                        <div id="errors" style="display: none;">
                            <!--Display validation errors here-->
                            <div class="alert alert-danger">
                                <ul id="alerts"></ul>
                            </div>
                        </div>

                        <input type="hidden" id="status_ekthesis" name="status_ekthesis"
                            value="<%= data.status_ekthesis%>">
                        <input type="hidden" id="author" name="author" value="<%= data.author%>">

                        <fieldset id="arxiki">

                            <h2>Ανάλυση Συνεπειών Ρύθμισης</h2>
                            <br>

                            <div>
                                <h4 id="subtitle"></h4>
                                <br>
                                <p id="subtext"></p>
                                <br>
                                <hr>
                            </div>
                            <br>

                            <!-- Button trigger modal -->
                            <button type="button" class="btn btn-primary" style="float: right;" data-toggle="modal"
                                data-target="#versioningModal" id="modalButton">
                                Launch demo modal
                            </button>

                            <!-- Modal -->
                            <div class="modal fade" id="versioningModal" tabindex="-1" role="dialog"
                                aria-labelledby="versioningModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="versioningModalLabel">Ιστορικό Ανάλυσης</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body" id="modal_body">
                                            <div id="versions_table">
                                                <table id="versions" class="display">
                                                    <thead>
                                                        <tr>
                                                            <th>Επιλογή</th>
                                                            <th>Ημερομηνία αποθήκευσης</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary"
                                                data-dismiss="modal">Κλείσιμο</button>
                                            <button type="button" id="modal_submit"
                                                class="btn btn-primary">Υποβολή</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Modal -->
                            <div class="modal fade" id="versioningResultsModal" tabindex="-1" role="dialog"
                                aria-labelledby="versioningResultsModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="versioningResultsModalLabel">Αποτελέσματα</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body" id="results_body">
                                            <div id="results_table" class="table-wrapper-scroll-y my-custom-scrollbar">
                                                <table id="results" class="display">
                                                    <thead>
                                                        <tr>
                                                            <th>Πεδίο</th>
                                                            <th>Διαφορές</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary"
                                                data-dismiss="modal">Κλείσιμο</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <input type="button" name="convert" class="convert" style="display: none; float: right;"
                                value="Μετατροπή" />
                            <br><br>
                            <button class="btn delete-analysis float-right" style="float: right;" type="button"><img
                                    src="/img/delete.png" width="25px"></button>
                            <br><br>

                            <div class="form-group row">
                                <label for="title" class="required col-sm-6 col-form-label">Τίτλος αξιολογούμενης
                                    ρύθμισης</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="title" name="title"
                                        value="<%= data.title %>">
                                </div>
                            </div>
                            <br>

                            <div class="form-group row">
                                <label for="typos_analysis" class="col-sm-6 col-form-label required">Τύπος
                                    ανάλυσης</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="typos_analysis" name="typos_analysis"
                                        value="<%= data.typos_analysis%>" readonly>
                                </div>
                            </div>
                            <br>
                            <hr>

                            <div class="form-group row">
                                <label for="initial_submit" class="col-sm-6 col-form-label required">Αρχική
                                    καταχώρηση</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="initial_submit" name="initial_submit"
                                        value="<%= data.initial_submit %>" readonly>
                                </div>
                            </div>
                            <br>
                            <hr>

                            <div class="form-group row">
                                <label for="last_updated" class="col-sm-6 col-form-label required">Τελευταία
                                    ενημέρωση</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="last_updated" name="last_updated"
                                        value="<%= data.last_updated %>" readonly>
                                </div>
                            </div>
                            <br>
                            <hr>

                            <div class="form-group row">
                                <label for="epispeudon_foreas required" class="col-sm-6 col-form-label">Επισπεύδων
                                    φορέας</label>
                                <div class="col-sm-4">
                                    <textarea class="form-control" id="epispeudon_foreas" name="epispeudon_foreas"
                                        rows="3"><%= data.epispeudon_foreas %></textarea>
                                </div>
                            </div>
                            <hr>

                            <div class="form-group row">
                                <label for="rythmisi_pou_afora" class="col-sm-6 col-form-label">Ρύθμιση την οποία
                                    αφορά</label>
                                <div class="col-sm-4">
                                    <textarea class="form-control" id="rythmisi_pou_afora" name="rythmisi_pou_afora"
                                        rows="3" placeholder="Ρύθμιση"><%= data.rythmisi_pou_afora %></textarea>
                                </div>
                            </div>

                            <hr>
                            <div class="form-group row">
                                <label for="stoixeia_epikoinwnias required" class="col-sm-6 col-form-label">Στοιχεία
                                    επικοινωνίας</label>
                                <div class="col-sm-4">
                                    <textarea class="form-control" id="stoixeia_epikoinwnias"
                                        name="stoixeia_epikoinwnias"
                                        rows="3"><%= data.stoixeia_epikoinwnias %></textarea>
                                </div>
                            </div>

                            <br>
                            <hr>

                            <div id="nomosxedio_div">
                                <div id="upload_nomosxedio">
                                    <label for="nomosxedio" class="nomosxedio optional-label"
                                        id="nomosxedio_label">Επισύναψη Νομοσχεδίου</label>
                                    <br>
                                    <input type="file" id="nomosxedio" name="nomosxedio" accept=".pdf">
                                </div>

                                <br>
                                <table id="nomosxedio_table" class="display:none">
                                    <thead>
                                        <tr>
                                            <th colspan="2">Προηγούμενες αναρτήσεις:</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                        <% if( data.nomosxedio && data.nomosxedio.length) { for (var
                                            i=data.nomosxedio.length-1; i>=0 ; i--) { %>
                                            <tr>
                                                <td>
                                                    <a href="/uploads/<%= data.nomosxedio[i].filename %> ">
                                                        <%= data.nomosxedio[i].filename %>
                                                    </a>
                                                </td>
                                                <td>
                                                    <%= data.nomosxedio[i].upload_date %>
                                                </td>
                                            </tr>
                                            <% } }%>

                                    </tbody>
                                </table>
                                <br>
                            </div>

                            <br>
                            <hr>

                            <p>Επιλέξατε από τον παρακάτω κατάλογο τον τομέα ή τους τομείς νομοθέτησης στους οποίους
                                αφορούν
                                οι βασικές διατάξεις της αξιολογούμενης ρύθμισης:
                            <div class="index_tomeis"></div>
                            </p>
                            <div class="checkbox-group form-group row">
                                <label for="ekpedeusi_politismos" class="col-sm-8 col-form-label">ΕΚΠΑΙΔΕΥΣΗ -
                                    ΠΟΛΙΤΙΣΜΟΣ</label>
                                <input class="col-sm-2 form-check-input position-static" name="ekpedeusi_politismos"
                                    type="checkbox" id="ekpedeusi_politismos">
                            </div>

                            <div class="checkbox-group form-group row">
                                <label for="eksoteriki_politiki" class="col-sm-8 col-form-label">ΕΘΝΙΚΗ ΑΜΥΝΑ -
                                    ΕΞΩΤΕΡΙΚΗ ΠΟΛΙΤΙΚΗ</label>
                                <input class="col-sm-2 form-check-input position-static" type="checkbox"
                                    id="eksoteriki_politiki" name="eksoteriki_politiki">
                            </div>
                            <div class="checkbox-group form-group row">
                                <label for="forologiki_politiki" class="col-sm-8 col-form-label">ΟΙΚΟΝΟΜΙΚΗ /
                                    ΔΗΜΟΣΙΟΝΟΜΙΚΗ / ΦΟΡΟΛΟΓΙΚΗ ΠΟΛΙΤΙΚΗ</label>
                                <input class="col-sm-2 form-check-input position-static" type="checkbox"
                                    id="forologiki_politiki" name="forologiki_politiki">
                            </div>
                            <div class="checkbox-group form-group row">
                                <label for="koinoniki_politiki" class="col-sm-8 col-form-label">ΚΟΙΝΩΝΙΚΗ
                                    ΠΟΛΙΤΙΚΗ</label>
                                <input class="col-sm-2 form-check-input position-static" type="checkbox"
                                    id="koinoniki_politiki" name="koinoniki_politiki">
                            </div>
                            <div class="checkbox-group form-group row">
                                <label for="dimosia_dioikisi" class="col-sm-8 col-form-label">ΔΗΜΟΣΙΑ ΔΙΟΙΚΗΣΗ - ΔΗΜΟΣΙΑ
                                    ΤΑΞΗ - ΔΙΚΑΙΟΣΥΝΗ</label>
                                <input class="col-sm-2 form-check-input position-static" type="checkbox"
                                    id="dimosia_dioikisi" name="dimosia_dioikisi">
                            </div>
                            <div class="checkbox-group form-group row">
                                <label for="anaptiksi" class="col-sm-8 col-form-label">ΑΝΑΠΤΥΞΗ - ΕΠΕΝΔΥΤΙΚΗ
                                    ΔΡΑΣΤΗΡΙΟΤΗΤΑ</label>
                                <input class="col-sm-2 form-check-input position-static" type="checkbox" id="anaptiksi"
                                    name="anaptiksi">
                            </div>
                            <input type="button" name="next" class="next action-button" value="Επόμενα πεδία" />

                        </fieldset>

                        <fieldset id="tautotita_ruthmisis">
                            <h2>Α. Αιτιολογική έκθεση</h2>
                            <br>
                            <h2>Η «ταυτότητα» της αξιολογούμενης ρύθμισης</h2>
                            <br>

                            <div class="form-group">
                                <label class="required" for="field_1">1. Ποιο ζήτημα αντιμετωπίζει η αξιολογούμενη
                                    ρύθμιση;</label>
                                <textarea class="form-control" id="field_1" name="field_1" rows="3"
                                    onkeypress="wordsCounter('field_1','words1', event)"
                                    onpaste="wordsCounter('field_1','words1', event)"><%= data.field_1 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words1"></span></p>
                            </div>

                            <div class="form-group ">
                                <label class="required" for="field_2">2. Γιατί αποτελεί πρόβλημα;</label>
                                <textarea class="form-control" id="field_2" name="field_2" rows="3"
                                    onkeypress="wordsCounter('field_2','words2', event)"
                                    onpaste="wordsCounter('field_2','words2', event)"><%= data.field_2 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words2"></span></p>
                            </div>

                            <div class="form-group">
                                <label class="required" for="field_3">3. Ποιους φορείς ή πληθυσμιακές ομάδες
                                    αφορά;</label>
                                <textarea class="form-control" id="field_3" name="field_3" rows="3"
                                    onkeypress="wordsCounter('field_3','words3', event)"
                                    onpaste="wordsCounter('field_3','words3', event)"><%= data.field_3 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words3"></span></p>
                            </div>

                            <input type="button" name="previous" class="previous action-button-previous"
                                value="Προηγούμενα πεδία" />
                            <input type="button" name="next" class="next action-button" value="Επόμενα πεδία" />
                        </fieldset>

                        <fieldset id="anagkaiotita_rythmisis_1">
                            <h2>Η αναγκαιότητα της αξιολογούμενης ρύθμισης</h2>
                            <br>
                            <div class="checkbox-group form-group row">
                                <label for="field_4" class="required col-sm-8 col-form-label">4. Το εν λόγω ζήτημα έχει
                                    αντιμετωπιστεί με νομοθετική ρύθμιση στο παρελθόν;</label>
                                <select id="field_4" name="field_4" class="col-sm-2 form-control">
                                    <option selected disabled>Eπιλογή</option>
                                    <option value="Ναι">Ναι</option>
                                    <option value="Όχι">Όχι</option>
                                </select>
                            </div>

                            <div id="field_4_wrap" class="form-group" style="display:none;">
                                <label class="required" for="field_4_1">4.1 Ποιο είναι το ισχύον νομικό πλαίσιο που
                                    ρυθμίζει το
                                    ζήτημα;</label>
                                <textarea class="form-control" id="field_4_1" name="field_4_comments" rows="3"
                                    onkeypress="wordsCounter('field_4_1','words4', event)"
                                    onpaste="wordsCounter('field_4_1','words4', event)"><%= data.field_4_comments %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words4"></span></p>
                            </div>

                            <input type="button" name="previous" class="previous action-button-previous"
                                value="Προηγούμενα πεδία" />
                            <input type="button" name="next" class="next action-button" value="Επόμενα πεδία" />
                        </fieldset>

                        <fieldset id="anagkaiotita_rythmisis_2">

                            <label>5. Γιατί δεν είναι δυνατό να αντιμετωπιστεί στο πλαίσιο της υφιστάμενης
                                νομοθεσίας:</label>
                            <div class="form-group">
                                <label class="required" for="field_5_1">5.1 με αλλαγή προεδρικού διατάγματος, υπουργικής
                                    απόφασης ή άλλης
                                    κανονιστικής πράξης;</label>
                                <textarea class="form-control" id="field_5_1" name="field_5_1" rows="3"
                                    onkeypress="wordsCounter('field_5_1','words5_1', event)"
                                    onpaste="wordsCounter('field_5_1','words5_1', event)"><%= data.field_5_1 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words5_1"></span></p>
                            </div>

                            <div class="form-group">
                                <label class="required" for="field_5_2">5.2 με αλλαγή διοικητικής πρακτικής
                                    συμπεριλαμβανομένης της
                                    δυνατότητας νέας ερμηνευτικής προσέγγισης της υφιστάμενης νομοθεσίας;</label>
                                <textarea class="form-control" id="field_5_2" name="field_5_2" rows="3"
                                    onkeypress="wordsCounter('field_5_2','words5_2', event)"
                                    onpaste="wordsCounter('field_5_2','words5_2', event)"><%= data.field_5_2 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words5_2"></span></p>
                            </div>

                            <div class="form-group">
                                <label class="required" for="field_5_3">5.3 με διάθεση περισσότερων ανθρώπινων και
                                    υλικών πόρων;</label>
                                <textarea class="form-control" id="field_5_3" name="field_5_3" rows="3"
                                    onkeypress="wordsCounter('field_5_3','words5_3', event)"
                                    onpaste="wordsCounter('field_5_3','words5_3', event)"><%= data.field_5_3 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words5_3"></span></p>
                            </div>

                            <input type="button" name="previous" class="previous action-button-previous"
                                value="Προηγούμενα πεδία" />
                            <input type="button" name="next" class="next action-button" value="Επόμενα πεδία" />
                        </fieldset>

                        <fieldset id="sunafeis_praktikes">
                            <h2>Συναφείς πρακτικές</h2>
                            <br>
                            <div class="checkbox-group form-group row">
                                <label for="field_6" class="required col-sm-8 col-form-label">6. Έχετε λάβει υπόψη
                                    συναφείς πρακτικές;</label>
                                <select id="field_6" name="field_6" class="col-sm-2 form-control">
                                    <option selected disabled>Eπιλογή</option>
                                    <option value="Ναι">Ναι</option>
                                    <option value="Όχι">Όχι</option>
                                </select>
                            </div>

                            <div id="field_6_wrap" class="form-group" style="display:none;">
                                <div class="form-group">
                                    <label class="required" for="field_6_1">6.1 Σε άλλη/ες χώρα/ες της Ε.Ε. ή του
                                        ΟΟΣΑ:</label>
                                    <textarea class="form-control" id="field_6_1" name="field_6_1" rows="3"
                                        onkeypress="wordsCounter('field_6_1','words6_1', event)"
                                        onpaste="wordsCounter('field_6_1','words6_1', event)"><%= data.field_6_1 %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words6_1"></span></p>
                                </div>
                                <br>
                                <div class="form-group">
                                    <label for="field_6_2">6.2 Σε όργανα της Ε.Ε.:</label>
                                    <textarea class="form-control" id="field_6_2" name="field_6_2"
                                        onkeypress="wordsCounter('field_6_2','words6_2', event)"
                                        onpaste="wordsCounter('field_6_2','words6_2', event)"><%= data.field_6_2 %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words6_2"></span></p>
                                </div>
                                <div class="form-group">
                                    <label for="field_6_3">6.3 Σε διεθνείς οργανισμούς:</label>
                                    <textarea class="form-control" id="field_6_3" name="field_6_3" rows="3"
                                        onkeypress="wordsCounter('field_6_3','words6_3', event)"
                                        onpaste="wordsCounter('field_6_3','words6_3', event)"><%= data.field_6_3 %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words6_3"></span></p>
                                </div>
                            </div>
                            <input type="button" name="previous" class="previous action-button-previous"
                                value="Προηγούμενα πεδία" />
                            <input type="button" name="next" class="next action-button" value="Επόμενα πεδία" />
                        </fieldset>

                        <fieldset id="stoxoi_ruthmisis">
                            <h2>Στόχοι αξιολογούμενης ρύθμισης</h2>
                            <br>
                            <div id="field_7_wrap">
                                <label class="col-form-label">7. Σημειώστε ποιοι από τους στόχους βιώσιμης ανάπτυξης των
                                    Ηνωμένων Εθνών επιδιώκονται με την αξιολογούμενη ρύθμιση</label>
                                <div class="index_goals"></div>
                                <div class="flex-form-group form-group">
                                    <div class="wrap">
                                        <% if(data.field_7_goal_1){ %>
                                            <input id="goal_1" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_1" value="<%=data.field_7_goal_1%>" checked>
                                            <% }else{ %>
                                                <input id="goal_1" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_1" value="goal-1">
                                                <% } %>
                                                    <label for="goal_1" class="checkbox-label"><img
                                                            src="/img/gr-goal-1.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_2){ %>
                                            <input id="goal_2" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_2" value="<%=data.field_7_goal_2%>" checked>
                                            <% }else{ %>
                                                <input id="goal_2" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_2" value="goal-2">
                                                <% } %>
                                                    <label for="goal_2" class="checkbox-label"><img
                                                            src="/img/gr-goal-2.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_3){ %>
                                            <input id="goal_3" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_3" value="<%=data.field_7_goal_3%>" checked>
                                            <% }else{ %>
                                                <input id="goal_3" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_3" value="goal-3">
                                                <% } %>
                                                    <label for="goal_3" class="checkbox-label"><img
                                                            src="/img/gr-goal-3.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_4){ %>
                                            <input id="goal_14" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_4" value="<%=data.field_7_goal_4%>" checked>
                                            <% }else{ %>
                                                <input id="goal_4" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_4" value="goal-4">
                                                <% } %>
                                                    <label for="goal_4" class="checkbox-label"><img
                                                            src="/img/gr-goal-4.jpg" width="100px"></label>
                                    </div>

                                </div>
                                <div class="flex-form-group form-group">
                                    <div class="wrap">
                                        <% if(data.field_7_goal_5){ %>
                                            <input id="goal_5" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_5" value="<%=data.field_7_goal_5%>" checked>
                                            <% }else{ %>
                                                <input id="goal_5" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_5" value="goal-5">
                                                <% } %>
                                                    <label for="goal_5" class="checkbox-label"><img
                                                            src="/img/gr-goal-5.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_6){ %>
                                            <input id="goal_6" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_6" value="<%=data.field_7_goal_6%>" checked>
                                            <% }else{ %>
                                                <input id="goal_6" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_6" value="goal-6">
                                                <% } %>
                                                    <label for="goal_6" class="checkbox-label"><img
                                                            src="/img/gr-goal-6.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_7){ %>
                                            <input id="goal_7" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_7" value="<%=data.field_7_goal_7%>" checked>
                                            <% }else{ %>
                                                <input id="goal_7" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_7" value="goal-7">
                                                <% } %>
                                                    <label for="goal_7" class="checkbox-label"><img
                                                            src="/img/gr-goal-7.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_8){ %>
                                            <input id="goal_8" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_8" value="<%=data.field_7_goal_8%>" checked>
                                            <% }else{ %>
                                                <input id="goal_8" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_8" value="goal-8">
                                                <% } %>
                                                    <label for="goal_8" class="checkbox-label"><img
                                                            src="/img/gr-goal-8.jpg" width="100px"></label>
                                    </div>

                                </div>

                                <div class="flex-form-group form-group">
                                    <div class="wrap">
                                        <% if(data.field_7_goal_9){ %>
                                            <input id="goal_9" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_9" value="<%=data.field_7_goal_9%>" checked>
                                            <% }else{ %>
                                                <input id="goal_9" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_9" value="goal-9">
                                                <% } %>
                                                    <label for="goal_9" class="checkbox-label"><img
                                                            src="/img/gr-goal-9.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_10){ %>
                                            <input id="goal_10" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_10" value="<%=data.field_7_goal_10%>" checked>
                                            <% }else{ %>
                                                <input id="goal_10" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_10" value="goal-10">
                                                <% } %>
                                                    <label for="goal_10" class="checkbox-label"><img
                                                            src="/img/gr-goal-10.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_11){ %>
                                            <input id="goal_11" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_11" value="<%=data.field_7_goal_11%>" checked>
                                            <% }else{ %>
                                                <input id="goal_11" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_11" value="goal-11">
                                                <% } %>
                                                    <label for="goal_11" class="checkbox-label"><img
                                                            src="/img/gr-goal-11.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_12){ %>
                                            <input id="goal_12" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_12" value="<%=data.field_7_goal_12%>" checked>
                                            <% }else{ %>
                                                <input id="goal_12" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_12" value="goal-12">
                                                <% } %>
                                                    <label for="goal_12" class="checkbox-label"><img
                                                            src="/img/gr-goal-12.jpg" width="100px"></label>
                                    </div>
                                </div>
                                <div class="flex-form-group form-group">
                                    <div class="wrap">
                                        <% if(data.field_7_goal_13){ %>
                                            <input id="goal_13" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_13" value="<%=data.field_7_goal_13%>" checked>
                                            <% }else{ %>
                                                <input id="goal_13" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_13" value="goal-13">
                                                <% } %>
                                                    <label for="goal_13" class="checkbox-label"><img
                                                            src="/img/gr-goal-13.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_14){ %>
                                            <input id="goal_14" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_14" value="<%=data.field_7_goal_14%>" checked>
                                            <% }else{ %>
                                                <input id="goal_14" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_14" value="goal-14">
                                                <% } %>
                                                    <label for="goal_14" class="checkbox-label"><img
                                                            src="/img/gr-goal-14.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_15){ %>
                                            <input id="goal_15" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_15" value="<%=data.field_7_goal_15%>" checked>
                                            <% }else{ %>
                                                <input id="goal_15" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_15" value="goal-15">
                                                <% } %>
                                                    <label for="goal_15" class="checkbox-label"><img
                                                            src="/img/gr-goal-15.jpg" width="100px"></label>
                                    </div>
                                    <div class="wrap">
                                        <% if(data.field_7_goal_16){ %>
                                            <input id="goal_16" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_16" value="<%=data.field_7_goal_16%>" checked>
                                            <% }else{ %>
                                                <input id="goal_16" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_16" value="goal-16">
                                                <% } %>
                                                    <label for="goal_16" class="checkbox-label"><img
                                                            src="/img/gr-goal-16.jpg" width="100px"></label>
                                    </div>
                                </div>
                                <div class="flex-form-group form-group">
                                    <div class="wrap">
                                        <% if(data.field_7_goal_17){ %>
                                            <input id="goal_17" class="checkbox-inline" type="checkbox"
                                                name="field_7_goal_17" value="<%=data.field_7_goal_17%>" checked>
                                            <% }else{ %>
                                                <input id="goal_17" class="checkbox-inline" type="checkbox"
                                                    name="field_7_goal_17" value="goal-17">
                                                <% } %>
                                                    <label for="goal_17" class="checkbox-label"><img
                                                            src="/img/gr-goal-17.jpg" width="100px"></label>
                                    </div>
                                </div>
                            </div>
                            <hr>

                            <label>8. Ποιοι είναι οι στόχοι της αξιολογούμενης ρύθμισης;</label>
                            <div class="index_field_8"></div>
                            <div class="form-group">
                                <label for="field_8_1" class="required">8.1 βραχυπρόθεσμοι: </label>
                                <textarea class="form-control" id="field_8_1" name="field_8_1" rows="3"
                                    onkeypress="wordsCounter('field_8_1','words8_1', event)"
                                    onpaste="wordsCounter('field_8_1','words8_1', event)"><%= data.field_8_1 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words8_1"></span></p>
                            </div>

                            <div class="form-group">
                                <label class="required" for="field_8_2">8.2 μακροπρόθεσμοι: </label>
                                <textarea class="form-control" id="field_8_2" name="field_8_2" rows="3"
                                    onkeypress="wordsCounter('field_8_2','words8_2', event)"
                                    onpaste="wordsCounter('field_8_2','words8_2', event)"><%= data.field_8_2 %></textarea>
                                <p style="float: right;">Λέξεις: <span id="words8_2"></span></p>
                            </div>

                            <input type="button" name="previous" class="previous action-button-previous"
                                value="Προηγούμενα πεδία" />
                            <input type="button" name="next" class="next action-button" value="Επόμενα πεδία" />
                        </fieldset>

                        <%- include('fill_form/field_9.ejs') %>

                            <fieldset id="digital_governance">
                                <h2>Ψηφιακή διακυβέρνηση</h2>
                                <br>

                                <div class="checkbox-group form-group row ">
                                    <label class="col-sm-8 col-form-label digital-gov-label">10. Σε περίπτωση που
                                        προβλέπεται η χρήση
                                        πληροφοριακού συστήματος, ποια θα είναι η συμβολή αυτού στην επίτευξη των στόχων
                                        της
                                        αξιολογούμενης ρύθμισης: </label>
                                </div>

                                <div class="checkbox-group form-group row">
                                    <div class="col-2"></div>
                                    <label class="col-3 col-form-label">ΑΜΕΣΗ</label>
                                    <input class="col-2 form-check-input position-static" type="checkbox"
                                        id="field_10_amesi" name="field_10_amesi">
                                </div>
                                <div id="amesi_wrap" class="form-group digital_gov" style="display:none;">
                                    <label for="field_10_amesi_comments" class="digital-gov-label">Εάν είναι άμεση,
                                        εξηγήστε:</label>
                                    <textarea class="form-control" id="field_10_amesi_comments"
                                        name="field_10_amesi_comments" rows="3"
                                        onkeypress="wordsCounter('field_10_amesi_comments','words10_1', event)"
                                        onpaste="wordsCounter('field_10_amesi_comments','words10_1', event)"><%= data.field_10_amesi_comments %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words10_1"></span></p>
                                </div>

                                <div class="checkbox-group form-group row">
                                    <div class="col-2"></div>
                                    <label class="col-3 col-form-label">ΕΜΜΕΣΗ</label>
                                    <input class="col-2 form-check-input position-static" type="checkbox"
                                        id="field_10_emmesi" name="field_10_emmesi">
                                </div>

                                <div id="emesi_wrap" class="form-group digital_gov" style="display:none;">
                                    <label for="field_10_emmesi_comments" class="digital-gov-label">Εάν είναι έμμεση,
                                        εξηγήστε:</label>
                                    <textarea class="form-control" id="field_10_emmesi_comments"
                                        name="field_10_emmesi_comments" rows="3"
                                        onkeypress="wordsCounter('field_10_emmesi_comments','words10_2', event)"
                                        onpaste="wordsCounter('field_10_emmesi_comments','words10_2', event)"><%= data.field_10_emmesi_comments %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words10_2"></span></p>
                                </div>
                                <hr>

                                <div class="checkbox-group form-group row digital_gov">
                                    <label for="field_11" class="col-sm-8 col-form-label">11. Το προβλεπόμενο
                                        πληροφοριακό σύστημα είναι συμβατό με την εκάστοτε ψηφιακή στρατηγική της χώρας
                                        (Βίβλος Ψηφιακού Μετασχηματισμού);</label>
                                    <select id="field_11" name="field_11" class="col-sm-2 form-control">
                                        <option selected disabled>Eπιλογή</option>
                                        <option value="Ναι">Ναι</option>
                                        <option value="Όχι">Όχι</option>
                                    </select>
                                </div>

                                <div id="field_11_wrap" class="form-group digital_gov" style="display:none;">
                                    <label for="field_11_comments" class="digital-gov-label">Εξηγήστε</label>
                                    <textarea class="form-control" name="field_11_comments" id="field_11_comments"
                                        rows="3" onkeypress="wordsCounter('field_11_comments','words11', event)"
                                        onpaste="wordsCounter('field_11_comments','words11', event)"><%= data.field_11_comments %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words11"></span></p>
                                </div>
                                <hr>

                                <div class="checkbox-group form-group row digital_gov">
                                    <label for="field_12" class="col-sm-8 col-form-label">12. Διασφαλίζεται η
                                        διαλειτουργικότητα του εν λόγω πληροφοριακού συστήματος με άλλα υφιστάμενα
                                        συστήματα;</label>
                                    <select id="field_12" name="field_12" class="col-sm-2 form-control">
                                        <option selected disabled>Eπιλογή</option>
                                        <option value="Ναι">Ναι</option>
                                        <option value="Όχι">Όχι</option>
                                    </select>
                                </div>

                                <div id="field_12_wrap" class="form-group digital_gov" style="display:none;">
                                    <label for="field_12_comments" class="digital-gov-label">Αναφέρατε ποια είναι αυτά
                                        τα συστήματα:</label>
                                    <textarea class="form-control" name="field_12_comments" id="field_12_comments"
                                        rows="3" onkeypress="wordsCounter('field_12_comments','words12', event)"
                                        onpaste="wordsCounter('field_12_comments','words12', event)"><%= data.field_12_comments %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words12"></span></p>
                                </div>
                                <hr>

                                <div class="checkbox-group form-group row digital_gov">
                                    <label for="field_13" class="col-sm-8 col-form-label">13. Έχει προηγηθεί μελέτη
                                        βιωσιμότητας του προβλεπόμενου πληροφοριακού συστήματος;</label>
                                    <select id="field_13" name="field_13" class="col-sm-2 form-control">
                                        <option selected disabled>Eπιλογή</option>
                                        <option value="Ναι">Ναι</option>
                                        <option value="Όχι">Όχι</option>
                                    </select>
                                </div>

                                <div id="field_13_wrap" class="form-group digital_gov" style="display:none;">
                                    <label for="field_13_comments" class="digital-gov-label">Εξηγήστε</label>
                                    <textarea class="form-control" name="field_13_comments" id="field_13_comments"
                                        rows="3" onkeypress="wordsCounter('field_13_comments','words13', event)"
                                        onpaste="wordsCounter('field_13_comments','words13', event)"><%= data.field_13_comments %></textarea>
                                    <p style="float: right;">Λέξεις: <span id="words13"></span></p>
                                </div>

                                <input type="button" name="previous" class="previous action-button-previous"
                                    value="Προηγούμενα πεδία" />
                                <input type="button" name="next" class="next action-button" value="Επόμενα πεδία" />
                            </fieldset>

                            <fieldset id="kat_arthro_analusi" class="table-14">
                                <h2>Κατ’ άρθρο ανάλυση αξιολογούμενης ρύθμισης</h2>
                                <br>
                                <table class="table" id="field_14_table">
                                    <thead class="thead">
                                        <tr>
                                            <th colspan="2"><label id="table_14_label"
                                                    class="table-14-label required">14.Σύνοψη στόχων κάθε άρθρου<div
                                                        class="table-cell index_14"></div></label></th>
                                        </tr>
                                        <tr>

                                            <th colspan="1">Άρθρο<div class="table-cell index_article"></div>
                                            </th>
                                            <th colspan="1">Στόχος<div class="table-cell index_goal"></div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbody_14">

                                        <% if( data.field_14_arthro && data.field_14_arthro.length ) { for (var i=0; i <
                                            data.field_14_arthro.length; i++) { %>
                                            <tr id="table_14_row<%=i%>">

                                                <td><textarea class="form-control" id="field_14_arthro<%=i%>"
                                                        name="field_14_arthro<%=i%>"
                                                        rows="1"><%= Object.values(data.field_14_arthro[i]) %></textarea>
                                                </td>
                                                <td>
                                                    <textarea class="form-control" id="field_14_stoxos<%=i%>"
                                                        name="field_14_stoxos<%=i%>" rows="1"
                                                        onkeypress="wordsCounter('field_14_stoxos<%=i%>','words14_<%=i%>', event)"
                                                        onpaste="wordsCounter('field_14_stoxos<%=i%>','words14_<%=i%>', event)"><%= Object.values(data.field_14_stoxos[i]) %></textarea>
                                                    <p style="float: right;">Λέξεις: <span id="words14_<%=i%>"></span>
                                                    </p>
                                                    <br><br>
                                                    <button class="btn remove float-right" type="button"><img
                                                            src="/img/delete.png" width="20px"></button>
                                                </td>

                                            </tr>
                                            <% } } %>

                                    </tbody>
                                </table>

                                <input type="button" id="add_row_table_14" name="add_row_table_14" class="float-right"
                                    value="Επιπλέον σειρά" />

                                <br><br><br>
                                <input type="button" name="previous" class="previous action-button-previous"
                                    value="Προηγούμενα πεδία" />
                                <input type="button" name="next" class="next action-button" value="Επόμενη φόρμα" />
                            </fieldset>

                            <%- include('view_form/view_form_b.ejs') %>
                                <%- include('view_form/view_form_c.ejs') %>
                                    <%- include('fill_form/fill_form_d.ejs') %>
                                        <%- include('view_form/view_form_e.ejs') %>
                                            <%- include('view_form/view_form_f.ejs') %>
                                                <%- include('view_form/view_form_g.ejs') %>
                                                    <%- include('view_form/view_form_h.ejs') %>

                    </form>
                    <input type="button" name="save_temporarily" class="save_temporarily float-right"
                        value="Προσωρινή αποθήκευση" />

                </div>
            </div>
            <%- include('sidebar.ejs') %>

                <style>
                    .action-button,
                    .back {
                        font-size: 16px;
                    }

                    table {
                        border: 1px solid black;
                        width: 100%;
                        padding: 20px;
                        text-align: left;
                    }

                    table th {
                        background-color: grey;
                        text-align: center;
                        padding: 10px;
                    }

                    table td {
                        border: 1px dotted black;
                    }

                    li.active {
                        border-color: blue;
                        border-width: 1px;
                        border-style: dashed;
                    }

                    .tooltip_text[data-show] {
                        display: block;
                    }

                    .tooltip_text {

                        background: #333;
                        color: white;
                        font-weight: bold;
                        padding: 4px;
                        font-size: 13px;
                        border-radius: 4px;
                        /* width: 50%; */
                        display: none;

                    }

                    .arxiki_menu {
                        display: none
                    }

                    .arxiki_list:hover .arxiki_menu {
                        display: initial
                    }


                    .aitiologiki_menu {
                        display: none
                    }

                    .aitiologiki_list:hover .aitiologiki_menu {
                        display: initial
                    }

                    .ekthesi_syntagmatos_menu {
                        display: none
                    }

                    .ekthesi_syntagmatos_list:hover .ekthesi_syntagmatos_menu {
                        display: initial
                    }

                    .eidiki_ekthesi_menu {
                        display: none
                    }

                    .eidiki_ekthesi_list:hover .eidiki_ekthesi_menu {
                        display: initial
                    }

                    .ekthesi_genikwn_synepeiwn_menu {
                        display: none
                    }

                    .ekthesi_genikwn_synepeiwn_list:hover .ekthesi_genikwn_synepeiwn_menu {
                        display: initial
                    }

                    .ekthesi_diavouleusis_menu {
                        display: none
                    }

                    .ekthesi_diavouleusis_list:hover .ekthesi_diavouleusis_menu {
                        display: initial
                    }

                    .ekthesi_nomimotitas_menu {
                        display: none
                    }

                    .ekthesi_nomimotitas_list:hover .ekthesi_nomimotitas_menu {
                        display: initial
                    }

                    .pinakas_tropopoioymenwn_katargoymenwn_diataksewn_menu {
                        display: none
                    }

                    .pinakas_tropopoioymenwn_katargoymenwn_diataksewn_list:hover .pinakas_tropopoioymenwn_katargoymenwn_diataksewn_menu {
                        display: initial
                    }

                    .ekthesi_efarmogis_rythmisis_menu {
                        display: none
                    }

                    .ekthesi_efarmogis_rythmisis_list:hover .ekthesi_efarmogis_rythmisis_menu {
                        display: initial
                    }

                    .flex-form-group {
                        display: flex;
                        justify-content: space-between;
                        flex-wrap: wrap;
                    }

                    .flex-form-group .wrap {
                        min-width: 8em;
                        margin: 4px;
                        /* to add gap between rows */
                    }

                    fieldset {
                        position: relative;
                    }

                    fieldset:not(:first-of-type) {
                        display: none;
                    }

                    .explain_text {
                        font-size: 12px;
                    }

                    .checkbox-group {
                        display: flex;
                        align-items: center;
                    }

                    .form-check-input {
                        margin-top: 0px;
                    }

                    label {
                        font-weight: 700;
                    }

                    .parent {
                        display: flex;
                        flex-wrap: wrap;
                    }

                    .child {
                        flex: 1 0 21%;
                        /* explanation below */
                        margin: 5px;
                        height: 100px;
                        background-color: blue;
                    }

                    form label.required:after {
                        color: red;
                        content: " *";
                    }

                    .focused {
                        border: solid 1px red;
                    }

                    .display {
                        table-layout: fixed;
                        overflow-wrap: break-word;
                    }

                    .my-custom-scrollbar {
                        position: relative;
                        height: 200px;
                        overflow: auto;
                    }

                    .table-wrapper-scroll-y {
                        display: block;
                    }
                </style>

                <script type="text/javascript" src="/js/common_form_scripts.js"></script>
                <script type="text/javascript" src="/js/tooltips.js"></script>
                <script type="text/javascript" src="/js/common_form_events.js"></script>
                <script type="text/javascript" src="/js/form_a_scripts.js"></script>

                <script>
                    //TODO: anything bellow here should be moved
                    let answer;
                    let ekthesi_id = "<%= data.id %>";
                    let role = "<%= rolos%>";
                    let analysis = "<%= data.typos_analysis %>";
                    let pdf_exists = "<%= pdf_exists %>";
                    // console.log(pdf_exists + '\n');
                    let ministries = JSON.parse(' <%- JSON.stringify(ministries) %> ');
                    let ministers = JSON.parse(' <%- JSON.stringify(ministers) %> ');
                    //prevent user from going to a different form through url   
                    if (sessionStorage.getItem("referer") != ekthesi_id) {
                        window.location.href = "/user_views/history"
                    }

                    
                    let ministersRoles = JSON.parse(' <%- JSON.stringify(data.minister_role) %> ');                    
                    let ministersNames = JSON.parse(' <%- JSON.stringify(data.minister_name) %> ');
                    let ministersSurnames = JSON.parse(' <%- JSON.stringify(data.minister_surname) %> ');
                    let index = $("#tbody_ministers").prop("rows").length;
                    for (m in ministersRoles) {
                        $("#tbody_ministers").append(`
                            <tr id="R${++index}">  
                                <td> 
                                    <textarea class="form-control" id="minister_name${index}" name="minister_name${index}" placeholder="Όνομα" rows="1" readonly>${ministersNames[m].elem}</textarea> 
                                </td>    
                                <td> 
                                    <select id="minister_surname${index}" name="minister_surname${index}" class="col-sm-8 form-control" onchange="ministerSurnameOnChange('minister_name${index}', 'minister_surname${index}', 'minister_role${index}')" required></select>
                                </td> 
                                <td> 
                                    <textarea class="form-control" id="minister_role${index}" name="minister_role${index}" placeholder="Ιδιότητα" rows="5" readonly>${ministersRoles[m].elem}</textarea>
                                    <button class="btn remove float-right" type="button"><img src="/img/delete.png" width="20px"></button>
                                </td> 
                            </tr>`);
                        populateMinistersSurnameSelect(
                            `minister_surname${index}`,
                        );
                        $(`#minister_surname${index}`).val(ministersSurnames[m].elem);
                    }

                    $("form").on("submit", function (ev) {
                        onSubmitStatus();
                        updateForm(ev);
                    })
                    //TODO: update to FormData
                    function updateForm(ev) {
                        ev.preventDefault();
                        setDate("#last_updated");
                        var inputs = $("form").find("input:disabled");
                        $.each(inputs, () => {
                            $(inputs).prop("disabled", false);
                        });
                        var fd = new FormData($("form").get(0));
                        var checkbox = $("form").find("input[type=checkbox]:not(:checked)");//find all unchecked checkboxes 
                        $.each(checkbox, function (key, chckbx) {
                            fd.append($(chckbx).prop('name'), $(chckbx).value = '')//append to fd without value 
                        });

                        fd.append('f15', $('#field_15_rythmiseis').value = CKEDITOR.instances['field_15_rythmiseis'].getData());
                        fd.append('f16_2', $('#field_16_kratikos_proypologismos').value = CKEDITOR.instances['field_16_kratikos_proypologismos'].getData());
                        fd.append('f16_1', $('#field_16_proypologismos_forea').value = CKEDITOR.instances['field_16_proypologismos_forea'].getData());
                        fd.append('f17', $('#field_17_oikonomika_apotelesmata').value = CKEDITOR.instances['field_17_oikonomika_apotelesmata'].getData());

                        $.ajax({
                            url: '/form_a/' + ekthesi_id,
                            //data: $("form").serialize(),
                            data: fd,
                            contentType: false,
                            processData: false,
                            error: function (data) {
                                // var errors = JSON.parse(data.responseText);
                                // $('#errors').show();
                                // var alerts = '';
                                // for (i in errors) {
                                //     console.log(errors[i].msg)
                                //     alerts c+= "<li>" + errors[i].msg + "</li>";
                                // }
                                // if ($(this).val() === '') {
                                //     $(this).addClass("focused");
                                //     flag = false;
                                // }
                                // $('#alerts').empty();
                                // $('#alerts').html(alerts);
                                // window.scrollTo(0, 0);
                            },
                            success: function (data) {
                                //window.location.href = "/user_views/history"
                                window.location = data.redirect
                            },
                            type: 'PUT'
                        });
                    }

                    function createNewForm(ev) {
                        ev.preventDefault();
                        setDate($("#initial_submit"));
                        setDate($("#last_updated"));
                        var fd = new FormData($("form").get(0));
                        $.ajax({
                            url: `/create/${analysis}`,
                            data: fd,
                            contentType: false,
                            processData: false,
                            error: function (error) {
                                console.log(error);
                            },
                            success: function (data) {
                                window.location.href = "/user_views/history";
                            },
                            type: 'POST'
                        });
                    }

                    $(".delete-analysis").on("click", function (ev) {
                        ev.preventDefault();
                        answer = window.confirm("Είστε σίγουροι ότι θέλετε να διαγράψετε την ανάλυση;");
                        if (answer) {
                            $.ajax({
                                url: `/form_a/${ekthesi_id}/delete_analysis`,
                                error: function (error) {
                                    console.log(error);
                                },
                                success: function (data) {
                                    window.location.href = "/user_views/history";
                                },
                                type: 'DELETE'
                            });
                        }
                    });

                    $(".save_temporarily").on("click", function (ev) {
                        // var validationFlag;
                        // validationFlag = validateRequiredFields(validationFlag);
                        // console.log('validationFlag: ' + validationFlag)
                        // if (validationFlag) {
                        //     updateForm(ev);
                        // } else {
                        //     ev.preventDefault();
                        // }
                        updateForm(ev);
                    });

                    $(".back").on("click", function (ev) {
                        window.location.href = "/user_views/history";
                    });

                    $('.convert').on("click", function (ev) {
                        answer = window.confirm("Μετατροπή;");
                        if (answer) {
                            convertAnalysis("#typos_analysis");
                            createNewForm(ev);
                        }
                    });

                    $(".export-pdf").on("click", function (ev) {
                        ev.preventDefault();
                        var pdf_name = prompt("Παρακαλώ εισάγετε το όνομα του PDF");
                        if (pdf_name) {
                            $("#pdf_name").val(pdf_name);
                            var inputs = $("form").find("input:disabled");
                            var textareas = $("form").find("textarea:disabled");//find all textareas            
                            $.each(textareas, () => {
                                $(textareas).prop("disabled", false);
                            });//enable fields to be passed down to req.body to be exported
                            $.each(inputs, () => {
                                $(inputs).prop("disabled", false);
                            });
                            $("#ekpedeusi_politismos").prop("checked") ? $(".ekpaideysi-politismos :input").prop('disabled', false) : $(".ekpaideysi-politismos :input").prop('disabled', true)
                            $("#forologiki_politiki").prop("checked") ? $(".oikonomia :input").prop('disabled', false) : $(".oikonomia :input").prop('disabled', true)
                            $("#koinoniki_politiki").prop("checked") ? $(".koinoniki-politiki :input").prop('disabled', false) : $(".koinoniki-politiki :input").prop('disabled', true)
                            $("#dimosia_dioikisi").prop("checked") ? $(".dimosia-dioikisi :input").prop('disabled', false) : $(".dimosia-dioikisi :input").prop('disabled', true)
                            $("#anaptiksi").prop("checked") ? $(".ependyseis :input").prop('disabled', false) : $(".ependyseis :input").prop('disabled', true)
                            var fd = new FormData($("form").get(0));
                            var checkbox = $("form").find("input[type=checkbox]:not(:checked)");//find all unchecked checkboxes 
                            $.each(checkbox, function (key, chckbx) {
                                fd.append($(chckbx).prop('name'), $(chckbx).value = '')//append to fd without value 
                            });
                            fd = JSON.stringify(Object.fromEntries(fd));
                            $.ajax({
                                url: '/form_a/' + ekthesi_id,
                                //data: $("form").serialize(),
                                data: fd,
                                contentType: 'application/json',
                                processData: false,
                                error: function (error) {
                                    console.log(error);
                                    $.each(textareas, () => {
                                        $(textareas).prop("disabled", true);
                                    });//enable fields to be passed down to req.body to be exported
                                    $.each(inputs, () => {
                                        $(inputs).prop("disabled", true);
                                    });
                                },
                                success: function (data) {
                                    $.each(textareas, () => {
                                        $(textareas).prop("disabled", true);
                                    });//enable fields to be passed down to req.body to be exported
                                    $.each(inputs, () => {
                                        $(inputs).prop("disabled", true);
                                    });
                                    $("#pdf_download").html(`Το τελευταίο αποθηκευμένο PDF
                                    βρίσκεται <a href="/pdf_exports/${pdf_name}.pdf">εδώ</a>.`)
                                    $("#pdf_download").show();
                                },
                                type: 'POST'
                            })
                        } else if (pdf_name === "") {
                            alert("Το όνομα του PDF δεν πρέπει να είναι κενό!")
                        }
                    });

                    $(".export-glk").on("click", function (ev) {
                        ev.preventDefault();
                        var pdf_name = prompt("Παρακαλώ εισάγετε το όνομα του PDF");
                        if (pdf_name) {
                            $("#glk_pdf_name").val(pdf_name);
                            setDate("#field_16_genikos_date");
                            $.ajax({
                                url: `/form_a/export/glk/:${ekthesi_id}`,
                                //data: $("form").serialize(),
                                data: $("form").serialize(),
                                processData: false,
                                error: function (error) {
                                    console.log(error);
                                },
                                success: function (data) {
                                    $("#glk_pdf_download").html(`Το τελευταίο αποθηκευμένο PDF
                                    βρίσκεται <a href="/pdf_exports/${pdf_name}.pdf">εδώ</a>.`)
                                    $("#glk_pdf_download").show();
                                },
                                type: 'POST'
                            })
                        } else if (pdf_name === "") {
                            alert("Το όνομα του PDF δεν πρέπει να είναι κενό!")
                        }
                    });

                    //ajax call to find all versions of current analysis
                    $("#modalButton").on("click", function (ev) {
                        ev.preventDefault();
                        console.log("clicked")
                        $.ajax({
                            url: `/form_a/${ekthesi_id}/versions`,
                            error: function (error) {
                                console.log(error);
                            },
                            success: function (result) {
                                var rowCount = $('#versions_table tbody tr').length;
                                console.log(rowCount)
                                if (rowCount === 0) {
                                    for (i in result.entries) { //populate modal table
                                        $("#versions_table tbody").append(`
                                        <tr> 
                                            <td> 
                                                <input type="checkbox" id="${result.entries[i].id}" name="${result.entries[i].id}">
                                            </td> 
                                            <td>
                                                ${result.entries[i].timestamp}
                                            </td>                                               
                                        </tr>`
                                        );
                                    }
                                }
                            },
                            type: 'POST'
                        });
                    });


                    $("#modal_submit").on("click", function (ev) {
                        ev.preventDefault();
                        let selected = {};
                        let ids = $($("#versioningModal input:checked"))
                        selected['target1'] = ids[0].name
                        selected['target2'] = ids[1].name
                        $.ajax({
                            url: `/form_a/${ekthesi_id}/diff`,
                            data: selected,
                            error: function (error) {
                                console.log(error);
                            },
                            success: function (result) {
                                console.log(result)
                                $("#results_table tbody").empty()
                                for (i in result.data) {
                                    //TODO: check if result.data[i] is an array and has length to limit recursions      
                                    let elem = result.data[i];
                                    if (elem.length > 0) { //minimum lenght is 1
                                        for (j in elem) {
                                            let row = `<span style = "color: ${elem[j].color};">${elem[j].value}</span >`

                                            if (j == 0) {
                                                $("#results_table tbody").append(`
                                                    <tr> 
                                                        <td> 
                                                            ${i}
                                                        </td> 
                                                        <td>
                                                            ${row}
                                                        </td>                                               
                                                    </tr>`
                                                );
                                            } else {
                                                $("#results_table tbody tr:last td:last").append(` ${row}`)
                                            }
                                        }
                                    }
                                }
                                $('#versioningModal').modal('toggle');
                                $('#versioningResultsModal').modal('toggle');
                            },
                            type: 'POST'
                        });
                    });

                    //count & limit words
                    function wordsCounter(fieldId, spanId, wordlimit, event) {
                        Countable.on(document.getElementById(fieldId), counter => {
                            if (counter.words >= wordlimit) {
                                event.preventDefault();//if word limit is reached prevent typing
                            }
                            document.getElementById(spanId).innerHTML = counter.words.toString();
                        })
                    }

                    function onSubmitStatus() {

                        if ((role === "Αρμόδιος επισπεύδοντος Υπουργείου και άλλων συναρμόδιων Υπουργείων" || role === "Βουλευτής") || (role === "Νομοπαρασκευαστική Επιτροπή (ΓΓΝΚΘ)" && $('#status_ekthesis').val("Συντάσσεται"))) {
                            $('#status_ekthesis').val("Ολοκληρώθηκε");
                        } else if (role === "Επιτροπή Αξιολόγησης Ποιότητας της Νομοπαρασκευαστικής Διαδικασίας (ΓΓΝΚΘ)" || role === "Γραφείο Καλής Νομοθέτησης (ΓΓΝΚΘ)" || role === "Διεύθυνση Νομοπαρασκευαστικής Διαδικασίας (ΓΓΝΚΘ)") {
                            if ($("#egkrisi_aksiologisis_nomoparaskeyastikis").prop("checked") && $("#egkrisi_kalis_nomothetisis").prop("checked") && $("#egkrisi_dieuthinsis_nomoparaskeyastikis").prop("checked") && $("#egkrisi_genikou_grammatea").prop("checked")) {
                                $('#status_ekthesis').val("Οριστικοποιήθηκε");
                            }
                        } else if (role === "Γενικός Γραμματέας Νομικών και Κοινοβουλευτικών Θεμάτων") {
                            if ($('#status_ekthesis').val() === "Οριστικοποιήθηκε" && ($("#signed_pdf tbody>tr").length > 0 || $('#signed_pdf_upload').get(0).files.length > 0)) {
                                $('#status_ekthesis').prop("disabled", false);
                                $('#status_ekthesis').val("Κατατέθηκε");

                            } else if ($("#egkrisi_aksiologisis_nomoparaskeyastikis").prop("checked") && $("#egkrisi_kalis_nomothetisis").prop("checked") && $("#egkrisi_dieuthinsis_nomoparaskeyastikis").prop("checked") && $("#egkrisi_genikou_grammatea").prop("checked")) {
                                $('#status_ekthesis').val("Οριστικοποιήθηκε");
                            }

                        }
                    }


                    if (role === "Συντάκτης επισπεύδοντος Υπουργείου") {
                        if ($("#status_ekthesis").val() != "Συντάσσεται") {
                            optionalFields("#edit_form :input");
                            enableFields(".next");
                            enableFields(".previous");
                        }
                    }

                    if ($('#status_ekthesis').val() === "Οριστικοποιήθηκε") {
                        $("#edit_form :input").prop("disabled", true);
                        //$("#edit_form :input[type=checkbox]").prop("disable",true);
                    }

                    if ((role === "Νομοπαρασκευαστική Επιτροπή (ΓΓΝΚΘ)" && $("#pdf_download").prop("hidden") === false && $('#status_ekthesis').val() === "Οριστικοποιήθηκε") || ($('#status_ekthesis').val() === "Οριστικοποιήθηκε" && role === "Γενικός Γραμματέας Νομικών και Κοινοβουλευτικών Θεμάτων")) {
                        $("#signed_pdf_div").show();
                        $("#pdf_download").prop("disabled", false);
                        $("#signed_pdf_upload").prop("disabled", false);
                        $(".export-pdf").prop("disabled", false);
                        if ("<%= data.egkrisi_genikou_grammatea%>") {
                            $(".create-new").prop("disabled", false);
                        }
                        $(".next").prop("disabled", false);
                        $(".previous").prop("disabled", false);
                    }



                    // $("#egkrisi_aksiologisis_nomoparaskeyastikis,#egkrisi_kalis_nomothetisis,#egkrisi_dieuthinsis_nomoparaskeyastikis,#egkrisi_genikou_grammatea").on("change", function () {
                    //     submitVisibility();
                    // });                    

                    $("#egkrisi_aksiologisis_nomoparaskeyastikis").on("change", function () {
                        submitVisibility();
                    });

                    $("#egkrisi_kalis_nomothetisis").on("change", function () {
                        submitVisibility();
                    });

                    $("#egkrisi_dieuthinsis_nomoparaskeyastikis").on("change", function () {
                        submitVisibility();
                    });
                    $("#egkrisi_genikou_grammatea").on("change", function () {
                        submitVisibility();
                    });

                    $("#ekthesi_glk").on("change", function (ev) {
                        //actions to take when ΓΛΚ checks checkbox
                        if (role == "Γενικό Λογιστήριο του Κράτους") {
                            if (!this.checked) {
                                answer = window.confirm("Με την ενέργειά σας αυτή η έκθεση θεωρείται ολοκληρωμένη από μεριά σας και επιστρέφει "
                                    + "στον Αρμόδιο Συντάκτη ή στο Αρμόδιο Υπουργείο. Θέλετε να συνεχίσετε;");
                                if (answer) {
                                    $("#status_ekthesis").prop("disabled", false).val("Ελέγχθηκε από το Γενικό Λογιστήριο του Κράτους");
                                    setDate("#field_16_genikos_date");
                                    updateForm(ev); //once unchecked form is submitted/updated 
                                } else {
                                    $("#ekthesi_glk").prop('checked', true);
                                    $("#status_ekthesis").val("Εκκρεμεί η έκθεση Γενικού Λογιστηρίου του Κράτους");//change hidden input's value
                                }
                            }
                        } else if (this.checked) {
                            answer = window.confirm("Με την ενέργειά σας αυτή η έκθεση θα αποσταλλεί στο Γενικό Λογιστήριο του κράτους. Συνέχεια;");
                            if (answer) {
                                $("#status_ekthesis").val("Εκκρεμεί η έκθεση Γενικού Λογιστηρίου του Κράτους");
                            } else {
                                $("#status_ekthesis").val("<%= data.status_ekthesis %>");
                            }
                        } else {
                            $("#ekthesi_glk").prop('checked', false);
                            $("#status_ekthesis").val("<%= data.status_ekthesis %>");//change hidden input's value
                        }
                        console.log($("#status_ekthesis").val())
                    });


                    // $("#field_10_emmesi").on("change", function (ev) {
                    //     requiredDigitalGov("#field_10_emmesi");
                    //     $("#emesi_wrap").toggle();
                    // })

                    // $("#field_10_amesi").on("change", function (ev) {
                    //     $("#amesi_wrap").toggle();
                    //     requiredDigitalGov("#field_10_amesi");
                    // })

                    // $("#field_25_dikaio").on("change", function (ev) {
                    //     $("#dikaio_wrap").toggle();
                    // })

                    // $("#field_25_kanonismos").on("change", function (ev) {
                    //     $("#kanonismos_wrap").toggle();
                    // })

                    // $("#field_25_odigia").on("change", function (ev) {
                    //     $("#odigia_wrap").toggle();
                    // })

                    // $("#field_25_apofasi").on("change", function (ev) {
                    //     $("#apofasi_wrap").toggle();
                    // })

                    // $("#field_26_antrwpina_dikaiwmata").on("change", function (ev) {
                    //     $("#antrwpina_dikaiwmata_wrap").toggle();
                    // })

                    // $("#field_26_symvaseis").on("change", function (ev) {
                    //     $("#symvaseis_wrap").toggle();
                    // })

                    // $("#field_27_dikastirio").on("change", function (ev) {
                    //     $("#dikastirio_wrap").toggle();
                    // })

                    // $("#field_27_arxi").on("change", function (ev) {
                    //     $("#arxi_wrap").toggle();
                    // })

                    // $("#field_28_nomologia").on("change", function (ev) {
                    //     $("#nomologia_wrap").toggle();
                    // })

                    // $("#field_28_nomologia_dikaiwmatwn_anthrwpou").on("change", function (ev) {
                    //     $("#nomologia_dikaiwmatwn_anthrwpou_wrap").toggle();
                    // })

                    // $("#field_28_alla_dikastiria").on("change", function (ev) {
                    //     $("#alla_dikastiria_wrap").toggle();
                    // })

                    $(function (ev) {
                        if ($("#field_4").val() == "Ναι") {
                            $("#field_4_wrap").show();
                        }
                    })

                    $(function (ev) {
                        if ($("#field_6").val() == "Ναι") {
                            $("#field_6_wrap").show();
                        }
                    })

                    $(function (ev) {
                        if ($("#field_11").val() == "Ναι") {
                            $("#field_11_wrap").show();
                        }
                    })

                    $(function (ev) {
                        if ($("#field_12").val() == "Ναι") {
                            $("#field_12_wrap").show();
                        }
                    })

                    $(function (ev) {
                        if ($("#field_13").val() == "Ναι") {
                            $("#field_13_wrap").show();
                        }
                    })

                    $(function (ev) {
                        if ($("#field_36").val() == "Ναι") {
                            $("#field_36_wrap").show();
                        }
                    })

                    // $("#field_4").on("click", function (ev) {
                    //     if ($(this).val() == "Ναι") {
                    //         $("#field_4_wrap").show();
                    //     } else {
                    //         $("#field_4_wrap").hide();
                    //     }
                    // })

                    // $("#field_6").on("change", function (ev) {
                    //     if ($(this).val() == "Ναι") {
                    //         $("#field_6_wrap").show();
                    //     } else {
                    //         $("#field_6_wrap").hide();
                    //     }
                    // })

                    // $("#field_11").on("change", function (ev) {
                    //     if ($(this).val() == "Ναι") {
                    //         $("#field_11_wrap").show();
                    //     } else {
                    //         $("#field_11_wrap").hide();
                    //     }
                    // })

                    // $("#field_12").on("change", function (ev) {
                    //     if ($(this).val() == "Ναι") {
                    //         $("#field_12_wrap").show();
                    //     } else {
                    //         $("#field_12_wrap").hide();
                    //     }
                    // })

                    // $("#field_13").on("change", function (ev) {
                    //     if ($(this).val() == "Ναι") {
                    //         $("#field_13_wrap").show();
                    //     } else {
                    //         $("#field_13_wrap").hide();
                    //     }
                    // })

                    // $("#field_36").on("change", function (ev) {
                    //     if ($(this).val() == "Ναι") {
                    //         $("#field_36_wrap").show();
                    //     } else {
                    //         $("#field_36_wrap").hide();
                    //     }
                    // })

                    //refactor    
                    function optionalFields(fieldId) {
                        $(fieldId).prop('disabled', true);//find and disable field, button or fieldset
                        //console.log((fieldId));
                    };
                    //refactor
                    function enableFields(fieldId) {
                        $(fieldId).prop('disabled', false);//find and enable field or button
                        // console.log((fieldId));
                    };
                    //refactor
                    function optionalFieldsClassRemoval(fieldLabel, className) {
                        var items = document.getElementsByClassName(fieldLabel);
                        for (var i = 0; i < items.length; i++) {
                            $(items[i]).removeClass(className);//remove required class from label
                        }
                    };
                    //refactor
                    function addLabelClass(fieldLabel, className) {
                        $(fieldLabel).addClass(className);//remove required class from label
                    };
                    //refactor 
                    //console.log("analysis-> "+analysis); // log analysis type
                    if (analysis == "Κατευθυντήριες γραμμές") {

                        $("#subtitle").html("«Προκαταρκτική Ανάλυση Συνεπειών Ρύθμισης»");
                        $("#subtext").html(` Σύμφωνα με την παρ. 1 του άρθρου 63 του ν. 4622/2019 «Ο Υπουργός δύναται να υποβάλει στην Γενική Γραμματεία Νομικών και Κοινοβουλευτικών Θεμάτων: […] β) τις κατευθυντήριες γραμμές του σχεδίου νόμου μαζί με όποιο στοιχείο θεωρεί αναγκαίο να συμπεριληφθεί στην Ανάλυση Συνεπειών Ρύθμισης». <br>
                            Στο «εγχειρίδιο νομοπαρασκευαστικής μεθοδολογίας»  αναφέρεται ότι: <br>
                            - «Οι κατευθυντήριες γραμμές αναλύουν το σκεπτικό των αποφάσεων που οδήγησαν στην επιλογή τόσο του επιδιωκόμενου ρυθμιστικού αποτελέσματος, όσο και των μηχανισμών επίτευξής του. Συντάσσονται από στελέχη του Υπουργείου και παρέχουν όλα τα απαραίτητα στοιχεία για την προετοιμασία της νομοθεσίας, προσδιορίζοντας και, όπου είναι δυνατόν, ποσοτικοποιώντας τα επιδιωκόμενα ρυθμιστικά αποτελέσματα.».<br>
                            - «Στην περίπτωση της αποστολής κατευθυντηρίων γραμμών, πέραν των εκθέσεων του Γενικού Λογιστηρίου του Κράτους όπως επίσης του πεδίου που αφορά στην ηλεκτρονική διαβούλευση, δεν προσδοκάται η αποστολή των πεδίων που αφορούν την αιτιολογική έκθεση και την έκθεση εφαρμογής επί των συγκεκριμένων άρθρων.».`);

                        optionalFields(".mostly-optional :input");
                        optionalFields(".optional :input");
                        optionalFields(".table-14 :input");
                        optionalFields(".table-29 :input");
                        optionalFields(".table-30 :input");
                        enableFields(".create-new");
                        enableFields(".next");
                        enableFields(".previous");
                        $("#egkrisi_aksiologisis_nomoparaskeyastikis, #egkrisi_kalis_nomothetisis, #egkrisi_dieuthinsis_nomoparaskeyastikis, #egkrisi_genikou_grammatea").prop('disabled', false);
                        $("#pdf_download").prop("disabled", false);
                        $(".export-pdf").prop("disabled", false);
                        $("#signed_pdf_upload").prop("disabled", false);

                        optionalFieldsClassRemoval("mostly-optional-label", "required");
                        optionalFieldsClassRemoval("optional-label", "required");
                        optionalFieldsClassRemoval("field-23-label", "required");
                        optionalFieldsClassRemoval("table-14-label", "required");
                        optionalFieldsClassRemoval("table-29-label", "required");
                        optionalFieldsClassRemoval("table-30-label", "required");

                    } else if (analysis == "Προσχέδιο νόμου") {

                        $("#subtitle").html("«Προκαταρκτική Ανάλυση Συνεπειών Ρύθμισης»");
                        $("#subtext").html(`Σύμφωνα με την παρ. 1 του άρθρου 63 του ν. 4622/2019 «Ο Υπουργός δύναται να υποβάλει στην Γενική Γραμματεία Νομικών και Κοινοβουλευτικών Θεμάτων: α) προσχέδιο νόμου και προκαταρκτική ανάλυση συνεπειών ρύθμισης η οποία συμπεριλαμβάνει τα στοιχεία του άρθρου 62 που κρίνει αναγκαία …».<br>
                            Στο «εγχειρίδιο νομοπαρασκευαστικής μεθοδολογίας»  αναφέρεται ότι: <br>
                            - «Συστήνεται … η προκαταρκτική Ανάλυση Συνεπειών Ρύθμισης να έχει ως βάση το υπόδειγμα της πλήρους Ανάλυσης, εξαιρουμένων των εκθέσεων του Γενικού Λογιστηρίου του Κράτους όπως επίσης του πεδίου που αφορά στην ηλεκτρονική διαβούλευση».<br>
                            - «Σε κάθε περίπτωση, για να καταστεί δυνατή η περαιτέρω αξιολόγηση της Ανάλυσης απαιτείται οπωσδήποτε αυτή να συμπεριλαμβάνει: i) την εισήγηση των αρμόδιων προϊσταμένων Γενικών Διευθύνσεων Οικονομικών Υποθέσεων όπως ορίζεται στο άρθρο 24 παρ. 5 περ. ε του ν. 4270/2015. […] ii) ειδική αιτιολογία σε περίπτωση πρόβλεψης παρεκκλίσεων από τις διατάξεις του νόμου περί ενιαίου μισθολογίου (ν. 4354/2015 [ΦΕΚ Α’ 176]).».<br>`)

                        optionalFields(".mostly-optional :input");
                        optionalFieldsClassRemoval("field-23-label", "required");
                        optionalFieldsClassRemoval("mostly-optional-label", "required");

                    } else if (analysis == "Επείγον ή κατεπείγον νομοσχέδιο" || analysis == "Διεθνείς συμβάσεις" || analysis == "Τροπολογίες Υπουργών") {

                        switch (analysis) {
                            case "Επείγον ή κατεπείγον νομοσχέδιο":
                                $("#subtitle").html("«Συνοπτική Ανάλυση Συνεπειών Ρύθμισης»");
                                $("#subtext").html(`Σύμφωνα με την παρ. 3 του άρθρου 85 του Κανονισμού της Βουλής, εάν ένα νομοσχέδιο έχει χαρακτηρισθεί από την Κυβέρνηση ως επείγον ή κατεπείγον «απαιτείται να συνοδεύεται από συνοπτική Ανάλυση Συνεπειών Ρύθμισης που συμπεριλαμβάνει κατ’ ελάχιστον τις ανωτέρω ενότητες (α) και (ε), καθώς και στοιχεία από τις ενότητες (β) και (δ)», δηλαδή την αιτιολογική έκθεση και τον πίνακα τροποποιούμενων ή καταργούμενων διατάξεων, καθώς και στοιχεία της έκθεσης γενικών συνεπειών και της έκθεσης νομιμότητας. <br>
                                    Επίσης, στην περίπτωση νομοσχεδίου που συνεπάγεται επιβάρυνση του κρατικού προϋπολογισμού (βλ. παρ. 5 του άρθρου 88 του Κανονισμού της Βουλής), η Ανάλυση Συνεπειών Ρύθμισης πρέπει να ενσωματώνει: «την έκθεση του άρθρου 75 παρ. 1 του Συντάγματος από το Γενικό Λογιστήριο του Κράτους, η οποία προσδιορίζει τη δημοσιονομική επίπτωση επί του Προϋπολογισμού από τις διατάξεις της ρύθμισης, όπως επίσης, ανάλογα με το περιεχόμενό του, α) την ειδική έκθεση του αρμόδιου Υπουργού και του Υπουργού Οικονομικών που προβλέπει το άρθρο 75 παρ. 3 του Συντάγματος και β) τη γνωμοδότηση του Ελεγκτικού Συνεδρίου που ορίζει το άρθρο 73 παρ. 2 του Συντάγματος.». `);
                                break;
                            case "Διεθνείς συμβάσεις":
                                $("#subtitle").html("«Συνοπτική Ανάλυση Συνεπειών Ρύθμισης»");
                                $("#subtext").html(`Προσθήκη εισαγωγικού κειμένου μετά τον νέο υπότιτλο: Η κύρωση μιας διεθνούς σύμβασης εμπίπτει στο πεδίο εφαρμογής των ειδικών νομοθετικών διαδικασιών (βλ. άρθρο 112 του Κανονισμού της Βουλής) και ως εκ τούτου, σύμφωνα με την παρ. 3 του άρθρου 85 του Κανονισμού της Βουλής, το κυρωτικό νομοσχέδιο «απαιτείται να συνοδεύεται από συνοπτική Ανάλυση Συνεπειών Ρύθμισης που συμπεριλαμβάνει κατ’ ελάχιστον τις ανωτέρω ενότητες (α) και (ε), καθώς και στοιχεία από τις ενότητες (β) και (δ)», δηλαδή την αιτιολογική έκθεση και τον πίνακα τροποποιούμενων ή καταργούμενων διατάξεων, καθώς και στοιχεία της έκθεσης γενικών συνεπειών και της έκθεσης νομιμότητας. <br>
                                    Επίσης, στην περίπτωση νομοσχεδίου που συνεπάγεται επιβάρυνση του κρατικού προϋπολογισμού (βλ. παρ. 5 του άρθρου 88 του Κανονισμού της Βουλής), η Ανάλυση Συνεπειών Ρύθμισης πρέπει να ενσωματώνει: «την έκθεση του άρθρου 75 παρ. 1 του Συντάγματος από το Γενικό Λογιστήριο του Κράτους, η οποία προσδιορίζει τη δημοσιονομική επίπτωση επί του Προϋπολογισμού από τις διατάξεις της ρύθμισης, όπως επίσης, ανάλογα με το περιεχόμενό του, α) την ειδική έκθεση του αρμόδιου Υπουργού και του Υπουργού Οικονομικών που προβλέπει το άρθρο 75 παρ. 3 του Συντάγματος και β) τη γνωμοδότηση του Ελεγκτικού Συνεδρίου που ορίζει το άρθρο 73 παρ. 2 του Συντάγματος.». `);
                                break;
                            case "Τροπολογίες Υπουργών":
                                $("#subtitle").html("«Συνοπτική Ανάλυση Συνεπειών Ρύθμισης»");
                                $("#subtext").html(` Σύμφωνα με την παρ. 1 του άρθρου 62 του ν. 4622/2019 «Κάθε σχέδιο νόμου, προσθήκη ή τροπολογία, καθώς και κανονιστική απόφαση μείζονος οικονομικής ή κοινωνικής σημασίας, συνοδεύεται από Ανάλυση Συνεπειών Ρύθμισης (εφεξής Ανάλυση).».<br>
                                    Ειδικότερα, για τις τροπολογίες Υπουργών, στην παρ. 2 του άρθρου 88 του Κανονισμού της Βουλής προβλέπεται ότι συνοδεύονται από «σύντομη συνοπτική Ανάλυση Συνεπειών Ρύθμισης που συμπεριλαμβάνει κατ’ ελάχιστον τις ενότητες (α) και (ε), καθώς και στοιχεία από τις ενότητες (β) και (δ) της παρ. 3 του άρθρου 85», δηλαδή την αιτιολογική έκθεση και τον πίνακα τροποποιούμενων ή καταργούμενων διατάξεων, καθώς και στοιχεία της έκθεσης γενικών συνεπειών και της έκθεσης νομιμότητας. <br>
                                    Επίσης, σύμφωνα με την παρ. 5 του άρθρου 88 του Κανονισμού της Βουλής «Oι τρoπoλoγίες που συνεπάγονται επιβάρυνση του πρoϋπoλoγισμoύ του Κράτους διαβιβάζονται πριν από τη συζήτησή τoυς στo Γενικό Λoγιστήριo τoυ Kράτoυς, αν το ζητήσουν oι αρμόδιοι Yπoυργoί. Σ’ αυτήν την περίπτωση τo Γενικό Λογιστήριο τoυ Kράτoυς υπoχρεoύται να υποβάλει στη Boυλή την έκθεσή τoυ μέσα σε τρεις ημέρες από την παραλαβή τoυς. Mόνo αν η προθεσμία αυτή περάσει άπρακτη, oι τρoπoλoγίες μπoρoύν να συζητηθoύν και χωρίς την έκθεση.».`);
                                break;
                        }

                        optionalFields(".field-22 :input");
                        optionalFields(".optional :input");
                        enableFields(".create-new");
                        enableFields(".next");
                        enableFields(".previous");
                        $("#egkrisi_aksiologisis_nomoparaskeyastikis, #egkrisi_kalis_nomothetisis, #egkrisi_dieuthinsis_nomoparaskeyastikis, #egkrisi_genikou_grammatea").prop('disabled', false);
                        $("#pdf_download").prop("disabled", false);
                        $(".export-pdf").prop("disabled", false);

                        optionalFieldsClassRemoval("field-22-label", "required");
                        optionalFieldsClassRemoval("field-23-label", "required");
                        optionalFieldsClassRemoval("optional-label", "required");


                    } else if (analysis == "Τροπολογίες Βουλευτών" || analysis == "Πρόταση νόμου") {

                        switch (analysis) {
                            case "Τροπολογίες Βουλευτών":
                                $("#subtitle").html("«Συνοπτική Ανάλυση Συνεπειών Ρύθμισης»");
                                $("#subtext").html(`Σύμφωνα με την παρ. 1 του άρθρου 62 του ν. 4622/2019 «Κάθε σχέδιο νόμου, προσθήκη ή τροπολογία, καθώς και κανονιστική απόφαση μείζονος οικονομικής ή κοινωνικής σημασίας, συνοδεύεται από Ανάλυση Συνεπειών Ρύθμισης (εφεξής Ανάλυση).». <br>
                                    Ειδικότερα, για τις τροπολογίες Βουλευτών, στην παρ. 2 του άρθρου 88 του Κανονισμού της Βουλής προβλέπεται ότι συνοδεύονται «υποχρεωτικώς από συνοπτική Ανάλυση Συνεπειών Ρύθμισης, η οποία συμπεριλαμβάνει κατ’ ελάχιστον τις ενότητες (α) και (ε) της παρ. 3 του άρθρου 85», δηλαδή την αιτιολογική έκθεση και τον πίνακα τροποποιούμενων ή καταργούμενων διατάξεων.<br>
                                    Επίσης, σύμφωνα με την παρ. 5 του άρθρου 88 του Κανονισμού της Βουλής «Oι τρoπoλoγίες που συνεπάγονται επιβάρυνση του πρoϋπoλoγισμoύ του Κράτους διαβιβάζονται πριν από τη συζήτησή τoυς στo Γενικό Λoγιστήριo τoυ Kράτoυς, αν το ζητήσουν oι αρμόδιοι Yπoυργoί. Σ’ αυτήν την περίπτωση τo Γενικό Λογιστήριο τoυ Kράτoυς υπoχρεoύται να υποβάλει στη Boυλή την έκθεσή τoυ μέσα σε τρεις ημέρες από την παραλαβή τoυς. Mόνo αν η προθεσμία αυτή περάσει άπρακτη, oι τρoπoλoγίες μπoρoύν να συζητηθoύν και χωρίς την έκθεση.».`)
                                break;
                            case "Πρόταση νόμου":
                                $("#subtitle").html("«Συνοπτική Ανάλυση Συνεπειών Ρύθμισης»");
                                $("#subtext").html(` Σύμφωνα με την παρ. 3 του άρθρου 85 του Κανονισμού της Βουλής «Οι προτάσεις νόμων συνοδεύονται υποχρεωτικώς από συνοπτική Ανάλυση Συνεπειών Ρύθμισης, η οποία συμπεριλαμβάνει κατ’ ελάχιστον τις ανωτέρω ενότητες (α) και (ε)», δηλαδή την αιτιολογική έκθεση και τον πίνακα τροποποιούμενων ή καταργούμενων διατάξεων. <br>
                                    Επίσης, σύμφωνα με την παρ. 6 του άρθρου 85 του Κανονισμού της Βουλής «Κάθε πρόταση νόμου διαβιβάζεται στους αρμόδιους Yπoυργoύς, που έχουν υποχρέωση να απαντούν αν αυτή υπάγεται ή όχι στους περιορισμούς τoυ άρθρου 73 παρ. 3 τoυ Συντάγματος, καθώς και στo Γενικό Λoγιστήριo τoυ Kράτoυς για τη σύνταξη της έκθεσης που oρίζει τo άρθρο 75 παρ. 1 τoυ Συντάγματος. To Γενικό Λoγιστήριo τoυ Kράτoυς υπoχρεoύται να υπoβάλει στη Boυλή τη σχετική έκθεση μέσα σε δεκαπέντε ημέρες από την παραλαβή της πρότασης νόμoυ. Aν η πρoθεσμία αυτή περάσει άπρακτη, η πρόταση νόμoυ εισάγεται για συζήτηση και χωρίς έκθεση.». `)
                                break;
                        }

                        optionalFields(".field-18 :input");
                        optionalFields(".field-19 :input");
                        optionalFields(".field-20 :input");
                        optionalFields(".field-21 :input");
                        optionalFields(".field-22 :input");
                        optionalFields(".field-24 :input");
                        optionalFields(".field-25 :input");
                        optionalFields(".field-26 :input");
                        optionalFields(".field-27 :input");
                        optionalFields(".field-28 :input");
                        optionalFields(".table-31 :input");
                        optionalFields(".table-32 :input");
                        optionalFields(".optional :input");
                        enableFields(".create-new");
                        enableFields(".next");
                        enableFields(".previous");
                        $("#egkrisi_aksiologisis_nomoparaskeyastikis, #egkrisi_kalis_nomothetisis, #egkrisi_dieuthinsis_nomoparaskeyastikis, #egkrisi_genikou_grammatea").prop('disabled', false);
                        $("#pdf_download").prop("disabled", false);
                        $("#signed_pdf_upload").prop("disabled", false);
                        $(".export-pdf").prop("disabled", false);

                        optionalFieldsClassRemoval("field-18-label", "required");
                        optionalFieldsClassRemoval("field-19-label", "required");
                        optionalFieldsClassRemoval("field-20-label", "required");
                        optionalFieldsClassRemoval("field-21-label", "required");
                        optionalFieldsClassRemoval("field-22-label", "required");
                        optionalFieldsClassRemoval("field-23-label", "required");
                        optionalFieldsClassRemoval("field-24-label", "required");
                        optionalFieldsClassRemoval("field-25-label", "required");
                        optionalFieldsClassRemoval("field-26-label", "required");
                        optionalFieldsClassRemoval("field-27-label", "required");
                        optionalFieldsClassRemoval("field-28-label", "required");
                        optionalFieldsClassRemoval("table-31-label", "required");
                        optionalFieldsClassRemoval("table-32-label", "required");
                        optionalFieldsClassRemoval("optional-label", "required");

                    }

                    if (role === "Γενικό Λογιστήριο του Κράτους") {

                        $("#edit_form :input").prop("disabled", true);
                        //optionalFields("#edit_form :input:not([type=hidden])");
                        $(".ekpaideysi-politismos :input").prop('disabled', true);
                        $(".oikonomia :input").prop('disabled', true);
                        $(".koinoniki-politiki :input").prop('disabled', true);
                        $(".dimosia-dioikisi :input").prop('disabled', true);
                        $(".ependyseis :input").prop('disabled', true);
                        $("#status_ekthesis").prop(('disabled', false));
                        $(".glk :input").prop("disabled", false);
                        $("#status_ekthesis").prop("disabled", false);
                        console.log($("#status_ekthesis").val())
                        if ($("#status_ekthesis").val() === "Εκκρεμεί η έκθεση Γενικού Λογιστηρίου του Κράτους") {
                            $("#export_glk").hide();
                        }
                        // $(".export-pdf").prop("disabled", false);
                        enableFields(".next");
                        enableFields(".previous");
                    } else if (role == "Βουλή") {
                        optionalFields("#edit_form :input");
                        enableFields(document.getElementsByName("next"));
                        enableFields(document.getElementsByName("previous"));
                    } else {
                        optionalFields(".glk :input");
                        enableFields("#ekthesi_glk");
                        enableFields(".next");
                        enableFields(".previous");
                    }


                    function requiredDigitalGov(field) {
                        //if ($(field).prop("checked") && $('#status_ekthesis').val() !== "Οριστικοποιήθηκε") {
                        if ($(field).prop("checked")) {
                            addLabelClass($('.digital_gov'));
                            $('.digital-gov-label').addClass('required');
                            if ($(field).prop("disabled")) {
                                optionalFields($('.digital_gov :input'));
                            } else {
                                enableFields($('.digital_gov :input'));
                            }
                        } else {
                            optionalFields($('.digital_gov :input'));
                            $('.digital-gov-label').removeClass('required')
                        }
                    }

                    function requiredLegalistics(field) {

                        let spaceLess = $(field).val().replace(/^\s+|\s+$/g, "");//replace white space
                        if (spaceLess) {
                            $('.legalistic-label').addClass('required');
                            if ($(field).prop("disabled")) {
                                optionalFields($('.legalistic :input'));
                            } else {
                                enableFields($('.legalistic :input'));
                            }
                        } else {
                            optionalFields($('.legalistic :input'));
                            $('.legalistic-label').removeClass('required')
                        }
                    }

                    var tooltips = '<%= tooltips %>';
                    tooltips = textCleanUp(tooltips);
                    createTooltips(tooltips);


                    $(".close").on("click", function () {
                        $("#errors").hide();
                    })



                    //check if required fields are empty
                    function validateRequiredFields(validationFlag) {
                        $('#alerts').empty();
                        validationFlag = true;
                        var validField9 = true;
                        var errors;
                        //review
                        var textareas = $("form").find("textarea");//find all textareas            
                        $.each(textareas, function (key, field) {
                            //if ($(this).parent().find('label').hasClass('required') && $(this).prop('disabled',false)){                                                       
                            if ($(this).parent().find("label").hasClass("required")) {//if label nearest textarea is required, add class to textfield
                                $(this).addClass("required");
                            }
                        })
                        textareas.each(function () {
                            if ($(this).val() === '' && $(this).hasClass('required')) {
                                $(this).addClass("focused");
                                validationFlag = false;
                            }
                            if ($(this).val() !== '' && $(this).hasClass('focused')) {
                                $(this).removeClass("focused");
                                validationFlag = true;
                            }
                        })
                        if (validationFlag === false) {
                            $("#alerts").append("<li> Συμπληρώστε τα υποχρεωτικά πεδία </li>");
                            if ($("#errors").prop("hide", true)) {
                                $("#errors").show();
                                window.scrollTo(0, 0);
                            }
                        }

                        if ($("#ekpedeusi_politismos").prop("checked", true)) {
                            validField9 = focusElement($(".ekpaideysi-politismos :input"), validField9);
                        }
                        if ($("#forologiki_politiki").prop("checked", true)) {
                            validField9 = focusElement($(".oikonomia :input"), validField9);
                        }
                        if ($("#koinoniki_politiki").prop("checked", true)) {
                            validField9 = focusElement($(".koinoniki-politiki :input"), validField9);
                        }
                        if ($("#dimosia_dioikisi").prop("checked", true)) {
                            validField9 = focusElement($(".dimosia-dioikisi :input"), validField9);
                        }
                        if ($("#anaptiksi").prop("checked", true)) {
                            validField9 = focusElement($(".ependyseis :input"), validField9);
                        }
                        if (!validField9) {
                            validationFlag = validField9;
                            $("#alerts").append("<li> Υπάρχουν κενά πεδία στους πίνακες του πεδίου 9. </li>");
                            if ($("#errors").prop("hide", true)) {
                                $("#errors").show();
                                window.scrollTo(0, 0);
                            }
                        }
                        return validationFlag;
                    }

                    function focusElement(indexClass, flag) {
                        indexClass.each(function () {
                            if ($(this).val() === '') {
                                $(this).addClass("focused");
                                flag = false;
                            }
                        })
                        return flag;
                    }

                    // jQuery button click event to remove a file 
                    $('#uploads_21, #uploads_23, #uploads_36').on('click', '.remove-file', function (ev) {
                        ev.preventDefault();
                        $("#deleted_file").val($(this).closest('td').find('a').html());
                        var bttn = $(this);
                        if ($("#deleted_file").val()) {
                            $.ajax({
                                url: '/form_a/' + ekthesi_id + '/delete_file',
                                data: $("form").serialize(),
                                error: function (error) {
                                    console.log(error);
                                },
                                success: function (data) {
                                    $(bttn).closest('tr').remove();
                                    location.reload(true);
                                },
                                type: 'PUT'
                            });
                        }
                    });

                    // var current_fs, next_fs, previous_fs; //fieldsets

                    // //adding traversing functions to sidemenu
                    // (function ($) {
                    //     var $root = $('html, body');
                    //     $('a.menu').click(function () {
                    //         var href = $.attr(this, 'href');
                    //         current_fs = $("fieldset:visible");
                    //         $(".progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");
                    //         next_fs = $(href);
                    //         //hide the current fieldset with style
                    //         current_fs.hide();
                    //         //show the next fieldset
                    //         next_fs.show();
                    //         $(".progressbar li").eq($("fieldset").index(next_fs)).addClass("active");
                    //         window.scrollTo(0, 0);
                    //         return false;
                    //     });

                    // }(jQuery));

                    // $(".submit").click(function () {
                    //     return false;
                    // })
                </script>
                <script type="text/javascript" src="/js/initialize_form.js"></script>
        </div>
    </div>
    <%- include('partials/footer.ejs') %>
        </div>
        </body>

        </html>